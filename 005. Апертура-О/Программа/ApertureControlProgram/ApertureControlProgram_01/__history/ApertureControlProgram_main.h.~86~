//---------------------------------------------------------------------------

#ifndef ApertureControlProgram_mainH
#define ApertureControlProgram_mainH
//---------------------------------------------------------------------------
#include <Classes.hpp>
#include <Controls.hpp>
#include <StdCtrls.hpp>
#include <Forms.hpp>
#include "CommPort.h"
#include <ComCtrls.hpp>
#include <Dialogs.hpp>
#include <ExtCtrls.hpp>
#include <ImgList.hpp>
#include <Menus.hpp>
#include <ToolWin.hpp>
#include <Buttons.hpp>
//---------------------------------------------------------------------------
class TMainForm : public TForm
{
__published:	// IDE-managed Components
	TToolBar *ToolBar1;
	TToolButton *ToolButton3;
	TToolButton *TB_LoadBlp;
	TToolButton *ToolButton1;
	TToolButton *TB_LoadSar;
	TToolButton *ToolButton5;
	TToolButton *TB_SaveControl;
	TToolButton *ToolButton7;
	TToolButton *TB_SaveTesting;
	TToolButton *ToolButton2;
	TToolButton *TB_LoadControl;
	TToolButton *ToolButton4;
	TToolButton *TB_LoadTesting;
	TToolButton *ToolButton6;
	TToolButton *TB_About;
	TTimer *NIDAQmxTimer;
	TOpenDialog *OpenDialog1;
	TSaveDialog *SaveDialog1;
	TImageList *ImageList1;
	TCommPort *CommPort1;
	TSpeedButton *SB_OnOff;
	TGroupBox *GB_AvailableCom;
	TButton *B_AvailableCom;
	TPageControl *PC_Main;
	TTabSheet *Tsh_Control;
	TScrollBox *SB_Data2;
	TTabSheet *Sar_invisible;
	TLabel *L_H;
	TLabel *L_M;
	TLabel *L_S;
	TStaticText *StaticText4;
	TPanel *P_SystemTime;
	TStaticText *StaticText3;
	TPanel *P_WorkTime;
	TTimer *SystemTimer;
	TTimer *WorkTimer;
	TStatusBar *StatusBar1;
	TGroupBox *GroupBox1;
	TCheckBox *CheckBox1;
	TComboBox *ComboBox1;
	TGroupBox *GroupBox2;
	TCheckBox *CheckBox2;
	TComboBox *ComboBox2;
	TGroupBox *GroupBox3;
	TCheckBox *CheckBox3;
	TComboBox *ComboBox3;
	TCheckBox *CheckBox9;
	TGroupBox *GroupBox9;
	TCheckBox *CheckBox10;
	TComboBox *ComboBox5;
	TGroupBox *GroupBox10;
	TCheckBox *CheckBox11;
	TComboBox *ComboBox6;
	TGroupBox *GroupBox13;
	TCheckBox *CheckBox14;
	TRadioButton *RadioButton9;
	TRadioButton *RadioButton10;
	TGroupBox *GroupBox14;
	TCheckBox *CheckBox15;
	TRadioButton *RadioButton11;
	TRadioButton *RadioButton12;
	TGroupBox *GB_Message;
	TEdit *E_EnterComment;
	TMemo *M_Log;
	TStaticText *StaticText6;
	TStaticText *StaticText7;
	TButton *B_Enter;
	TCheckBox *ChB_Log;
	TButton *Button1;
	TTabSheet *Tsh_Testing;
	TScrollBox *ScrollBox1;
	TGroupBox *GroupBox30;
	TCheckBox *CheckBox29;
	TRadioButton *RadioButton15;
	TRadioButton *RadioButton16;
	TGroupBox *GroupBox31;
	TCheckBox *CheckBox30;
	TRadioButton *RadioButton17;
	TRadioButton *RadioButton18;
	TGroupBox *GroupBox32;
	TCheckBox *CheckBox31;
	TRadioButton *RadioButton19;
	TRadioButton *RadioButton20;
	TGroupBox *GroupBox33;
	TCheckBox *CheckBox32;
	TRadioButton *RadioButton21;
	TRadioButton *RadioButton22;
	TCheckBox *CheckBox33;
	TGroupBox *GroupBox36;
	TCheckBox *CheckBox36;
	TEdit *Edit32;
	TGroupBox *GroupBox37;
	TCheckBox *CheckBox37;
	TEdit *Edit33;
	TGroupBox *GroupBox4;
	TCheckBox *CheckBox4;
	TRadioButton *RadioButton1;
	TRadioButton *RadioButton2;
	TGroupBox *GroupBox5;
	TCheckBox *CheckBox5;
	TRadioButton *RadioButton3;
	TRadioButton *RadioButton4;
	TListBox *LB_AvailableCom;
	TGroupBox *GB_Commands;
	TLabel *Label16;
	TButton *B_Ready;
	TButton *B_Send;
	TComboBox *CB_ComNum;
	TGroupBox *GB_Command3;
	TStaticText *StaticText10;
	TStaticText *StaticText11;
	TEdit *E_Command3;
	TEdit *E_Command3_0;
	TStaticText *StaticText49;
	TComboBox *CB_Command3_1;
	TCheckBox *ChB_Command3;
	TStaticText *StaticText13;
	TEdit *E_Command4;
	TStaticText *StaticText15;
	TEdit *E_Command5;
	TComboBox *CB_SignC;
	TComboBox *CB_Shift;
	TStaticText *StaticText14;
	TGroupBox *GB_Command7;
	TCheckBox *ChB_Command7;
	TComboBox *CB_Command7;
	TGroupBox *GB_Com3;
	TCheckBox *ChB_Com3;
	TStaticText *StaticText16;
	TStaticText *StaticText17;
	TEdit *E_Com3_0;
	TEdit *E_Com3;
	TStaticText *StaticText51;
	TComboBox *CB_Com3_1;
	TStaticText *StaticText19;
	TEdit *E_Com4;
	TStaticText *StaticText21;
	TEdit *E_Com5;
	TComboBox *CB_SignT;
	TStaticText *StaticText18;
	TComboBox *CB_Shift_;
	TGroupBox *GB_Com6;
	TCheckBox *ChB_Com6;
	TComboBox *CB_Com6;
	TGroupBox *GB_Com7;
	TCheckBox *ChB_Com7;
	TComboBox *CB_Com7;
	TGroupBox *GB_Com8;
	TCheckBox *ChB_Com8;
	TComboBox *CB_Com8;
	TGroupBox *GB_Com9;
	TCheckBox *ChB_Com9;
	TComboBox *CB_Com9;
	TGroupBox *GB_Com10;
	TLabel *Label8;
	TCheckBox *ChB_Com10;
	TComboBox *CB_Com10;
	TStaticText *StaticText22;
	TGroupBox *GB_Com11;
	TLabel *Label9;
	TCheckBox *ChB_Com11;
	TComboBox *CB_Com11;
	TStaticText *StaticText23;
	TGroupBox *GB_Com13;
	TCheckBox *ChB_Com13;
	TLabel *Label1;
	TComboBox *CB_Output;
	TLabel *Label3;
	TComboBox *CB_AuxOut;
	TLabel *Label4;
	TEdit *E_OutFreq;
	TLabel *Label5;
	TLabeledEdit *LE_V;
	TLabeledEdit *LE_f;
	TLabeledEdit *LE_Dir;
	TLabeledEdit *LE_A;
	TLabeledEdit *LE_D;
	void __fastcall Button1Click(TObject *Sender);
	void __fastcall B_AvailableComClick(TObject *Sender);
	void __fastcall TB_AboutClick(TObject *Sender);
	void __fastcall HelpAboutProgClick(TObject *Sender);
	void __fastcall FormCreate(TObject *Sender);
	void __fastcall FormClose(TObject *Sender, TCloseAction &Action);
	void __fastcall B_EnterClick(TObject *Sender);
	void __fastcall ChB_LogClick(TObject *Sender);
	void __fastcall WorkTimerTimer(TObject *Sender);
	void __fastcall SB_OnOffClick(TObject *Sender);
	void __fastcall SystemTimerTimer(TObject *Sender);
	void __fastcall ExitClick(TObject *Sender);
	void __fastcall FormShow(TObject *Sender);
	void __fastcall E_Command3Change(TObject *Sender);
	void __fastcall E_Command3Exit(TObject *Sender);
	void __fastcall E_Command3KeyPress(TObject *Sender, wchar_t &Key);
	void __fastcall E_Command3_0Change(TObject *Sender);
	void __fastcall E_Command3_0Exit(TObject *Sender);
	void __fastcall CB_Command3_1Change(TObject *Sender);
	void __fastcall CB_SignCKeyPress(TObject *Sender, wchar_t &Key);
	void __fastcall CB_ShiftChange(TObject *Sender);
	void __fastcall E_Command4Change(TObject *Sender);
	void __fastcall E_Command4Exit(TObject *Sender);
	void __fastcall CB_SignCChange(TObject *Sender);
	void __fastcall CB_SignCExit(TObject *Sender);
	void __fastcall E_Command5Change(TObject *Sender);
	void __fastcall E_Command5Exit(TObject *Sender);
	void __fastcall CB_Command7Change(TObject *Sender);
	void __fastcall CB_Command7Exit(TObject *Sender);
	void __fastcall E_Com3Change(TObject *Sender);
	void __fastcall E_Com3Exit(TObject *Sender);
	void __fastcall CB_Com3_1Change(TObject *Sender);
	void __fastcall CB_Com3_1Exit(TObject *Sender);
	void __fastcall E_Com3_0Change(TObject *Sender);
	void __fastcall E_Com3_0Exit(TObject *Sender);
	void __fastcall CB_Shift_Change(TObject *Sender);
	void __fastcall CB_ShiftExit(TObject *Sender);
	void __fastcall CB_Shift_Exit(TObject *Sender);
	void __fastcall E_Com4Change(TObject *Sender);
	void __fastcall E_Com4Exit(TObject *Sender);
	void __fastcall E_Com5Change(TObject *Sender);
	void __fastcall E_Com5Exit(TObject *Sender);
	void __fastcall CB_SignTChange(TObject *Sender);
	void __fastcall CB_SignTExit(TObject *Sender);
	void __fastcall CB_Com6Change(TObject *Sender);
	void __fastcall CB_Com7Change(TObject *Sender);
	void __fastcall CB_Com8Change(TObject *Sender);
	void __fastcall CB_Com9Change(TObject *Sender);
	void __fastcall CB_Com10Change(TObject *Sender);
	void __fastcall CB_Com11Change(TObject *Sender);
	void __fastcall CB_OutputChange(TObject *Sender);
	void __fastcall CB_AuxOutChange(TObject *Sender);
	void __fastcall E_OutFreqChange(TObject *Sender);
	void __fastcall TB_LoadBlpClick(TObject *Sender);
	void __fastcall TB_LoadSarClick(TObject *Sender);
	void __fastcall TB_SaveControlClick(TObject *Sender);
	void __fastcall TB_SaveTestingClick(TObject *Sender);
	void __fastcall TB_LoadControlClick(TObject *Sender);


private:	// User declarations
	String BlpFName;
	String SarFName;
public:		// User declarations
	__fastcall TMainForm(TComponent* Owner);
	void __fastcall TMainForm::SearchCOMPorts(void);
	String My_Patch;
	String logFname;
	void __fastcall TMainForm::AddSaveLog(String comment);
	void __fastcall TMainForm::ButtonsOn(void);
	bool TMainForm::IsValidInt(int min, int max, String value, String EdIzm);
	void TMainForm::ShowError(int ErrorNum, float Par1, float Par2, String Par3);
	void __fastcall TMainForm::BanCharInput(char &Key);
	bool __fastcall TMainForm::WriteDigChan(const char *Config, char *DigPort);
	float __fastcall TMainForm::ReadAnalogChan(const char *Config);
	String TMainForm::RoundValue(float delta, float fvalue);
	void __fastcall TMainForm::ResetBPControl(void);
	void __fastcall TMainForm::InitBPControl(void);
	bool TMainForm::IsValid(float min, float max, String value, String EdIzm);
	void __fastcall TMainForm::ResetBPTesting(void);
	void __fastcall TMainForm::InitBPTesting(void);
	void __fastcall TMainForm::Fvco_OD(void);
	void __fastcall TMainForm::Ndevider(void);
	void __fastcall TMainForm::UpdateRegister0(void);
	void __fastcall TMainForm::UpdateRegister1(void);
	void __fastcall TMainForm::UpdateRegister4(void);
};
//---------------------------------------------------------------------------
extern PACKAGE TMainForm *MainForm;
//---------------------------------------------------------------------------
#endif

